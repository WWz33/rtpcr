POSTHUC <- qpcrANOVA(x, numberOfrefGenes = 2)$Post_hoc_Test
}
Nrows <- length(unique(FINALDATA[,1])[-1])
withControl  <- POSTHUC[1:Nrows,]
withControl
# if check level be shown in the plot or not
if(showCheckLevel == TRUE) {
tableC <- rbind("1 - 1" = data.frame(row.names = "1 - 1", FC = 1, pvalue=1, signif.=" ", LCL=0, UCL=0), withControl)
rownames(tableC) <- level.names
} else {
tableC <- withControl
rownames(tableC) <- level.names[-1]
}
pairs <- rownames(tableC)
UCLp <- tableC$UCL
LCLp <- tableC$LCL
FCp <- tableC$FC
significance <- tableC$signif.
pfc <- ggplot(tableC, aes(factor(pairs, levels = level.names), FCp)) +
geom_col(col = "black", fill = fill, width = width) +
geom_errorbar(aes(pairs, ymin = FCp - LCLp, ymax =  FCp + UCLp),
width=0.1) +
geom_text(aes(label = significance,
x = pairs,
y = FCp + UCLp + letter.position.adjust),
vjust = -0.5, size = 8) +
ylab(ylab) + xlab(xlab) +
theme_bw()+
theme(axis.text.x = element_text(size = fontsize, color = "black", angle = 0, hjust = 0.5),
axis.text.y = element_text(size = fontsize, color = "black", angle = 0, hjust = 0.5),
axis.title  = element_text(size = fontsize)) +
scale_y_continuous(breaks=seq(0, max(UCLp) + max(FCp) + y.axis.adjust, by = y.axis.by),
limits = c(0, max(UCLp) + max(FCp) + y.axis.adjust + y.axis.adjust), expand = c(0, 0)) +
theme(legend.text = element_text(colour = "black", size = fontsize),
legend.background = element_rect(fill = "transparent"))
outlist <- list(plot = pfc,
Table = tableC)
return(outlist)
}
oneFACTORfcplot(data_1factor,
numberOfrefGenes = 1,
levels = c(3, 1, 2),
level.names = c("1", "2", "3"),
showCheckLevel = F,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 2,
letter.position.adjust = 0,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(data_1factor,
numberOfrefGenes = 1,
levels = c(3, 1, 2),
level.names = c("1", "2", "3"),
showCheckLevel = F,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 2,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
library(devtools)
document()
document()
remove.packages("iqpcr")
devtools::install_github("mirzaghaderi/iqpcr", build_vignettes = TRUE)
library(iqpcr)
a <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
a
a <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(data_1factor,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot
oneFACTORfcplot(data_1factor,
numberOfrefGenes = 1,
levels = c(1,2,3),
level.names = c("A1", "A2", "sfd"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
a <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot <- function(
x,
numberOfrefGenes,
levels,
showCheckLevel = TRUE,
level.names,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12){
xfl <- x[,1]
levels <- rev(levels)
x$SA <- levels[as.factor(xfl)]
if(numberOfrefGenes == 1) {
FINALDATA  <- qpcrANOVA(x, numberOfrefGenes = 1)$Final_data
POSTHUC <- qpcrANOVA(x, numberOfrefGenes = 1)$Post_hoc_Test
} else {
FINALDATA  <- qpcrANOVA(x, numberOfrefGenes = 2)$Final_data
POSTHUC <- qpcrANOVA(x, numberOfrefGenes = 2)$Post_hoc_Test
}
Nrows <- length(unique(FINALDATA[,1])[-1])
withControl  <- POSTHUC[1:Nrows,]
withControl
# if check level be shown in the plot or not
if(showCheckLevel == TRUE) {
tableC <- rbind("1 - 1" = data.frame(row.names = "1 - 1", FC = 1, pvalue=1, signif.=" ", LCL=0, UCL=0), withControl)
rownames(tableC) <- level.names
} else {
tableC <- withControl
rownames(tableC) <- level.names[-1]
}
pairs <- rownames(tableC)
UCLp <- tableC$UCL
LCLp <- tableC$LCL
FCp <- tableC$FC
significance <- tableC$signif.
pfc <- ggplot(tableC, aes(factor(pairs, levels = level.names), FCp)) +
geom_col(col = "black", fill = fill, width = width) +
geom_errorbar(aes(pairs, ymin = FCp - LCLp, ymax =  FCp + UCLp),
width=0.1) +
geom_text(aes(label = significance,
x = pairs,
y = FCp + UCLp + letter.position.adjust),
vjust = -0.5, size = 8) +
ylab(ylab) + xlab(xlab) +
theme_bw()+
theme(axis.text.x = element_text(size = fontsize, color = "black", angle = 0, hjust = 0.5),
axis.text.y = element_text(size = fontsize, color = "black", angle = 0, hjust = 0.5),
axis.title  = element_text(size = fontsize)) +
scale_y_continuous(breaks=seq(0, max(UCLp) + max(FCp) + y.axis.adjust, by = y.axis.by),
limits = c(0, max(UCLp) + max(FCp) + y.axis.adjust + y.axis.adjust), expand = c(0, 0)) +
theme(legend.text = element_text(colour = "black", size = fontsize),
legend.background = element_rect(fill = "transparent"))
outlist <- list(plot = pfc,
Table = tableC)
return(outlist)
}
library(ggplot2)
x <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
xfl <- x[,1]
levels <- rev(levels)
levels = c(1,2)
level.names = c("A1", "A2")
showCheckLevel = TRUE
width = 0.5
fill = "skyblue"
y.axis.adjust = 1
y.axis.by = 1
letter.position.adjust = 0.3
ylab = "Average Fold Change"
xlab = "Pairs"
fontsize = 12
x <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
xfl <- x[,1]
levels <- rev(levels)
x$SA <- levels[as.factor(xfl)]
x
xfl
colnames(x)[1]
condition <- colnames(x)[1]
x$condition <- levels[as.factor(xfl)]
x
x <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
xfl <- x[,1]
levels <- rev(levels)
condition <- colnames(x)[1]
x$condition <- levels[as.factor(xfl)]
xfl
numberOfrefGenes = 1,
numberOfrefGenes = 1
levels = c(1,2)
level.names = c("A1", "A2")
showCheckLevel = TRUE
width = 0.5
fill = "skyblue"
y.axis.adjust = 1
y.axis.by = 1
letter.position.adjust = 0.3
ylab = "Average Fold Change"
xlab = "Pairs"
fontsize = 12
x <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
xfl <- x[,1]
levels <- rev(levels)
condition <- colnames(x)[1]
x$condition <- levels[as.factor(xfl)]
x
FINALDATA  <- qpcrANOVA(x, numberOfrefGenes = 1)$Final_data
POSTHUC <- qpcrANOVA(x, numberOfrefGenes = 1)$Post_hoc_Test
Nrows <- length(unique(FINALDATA[,1])[-1])
withControl  <- POSTHUC[1:Nrows,]
withControl
tableC <- rbind("1 - 1" = data.frame(row.names = "1 - 1", FC = 1, pvalue=1, signif.=" ", LCL=0, UCL=0), withControl)
rownames(tableC) <- level.names
pairs <- rownames(tableC)
UCLp <- tableC$UCL
LCLp <- tableC$LCL
FCp <- tableC$FC
significance <- tableC$signif.
pfc <- ggplot(tableC, aes(factor(pairs, levels = level.names), FCp)) +
geom_col(col = "black", fill = fill, width = width) +
geom_errorbar(aes(pairs, ymin = FCp - LCLp, ymax =  FCp + UCLp),
width=0.1) +
geom_text(aes(label = significance,
x = pairs,
y = FCp + UCLp + letter.position.adjust),
vjust = -0.5, size = 8) +
ylab(ylab) + xlab(xlab) +
theme_bw()+
theme(axis.text.x = element_text(size = fontsize, color = "black", angle = 0, hjust = 0.5),
axis.text.y = element_text(size = fontsize, color = "black", angle = 0, hjust = 0.5),
axis.title  = element_text(size = fontsize)) +
scale_y_continuous(breaks=seq(0, max(UCLp) + max(FCp) + y.axis.adjust, by = y.axis.by),
limits = c(0, max(UCLp) + max(FCp) + y.axis.adjust + y.axis.adjust), expand = c(0, 0)) +
theme(legend.text = element_text(colour = "black", size = fontsize),
legend.background = element_rect(fill = "transparent"))
pfc
detach("package:iqpcr", unload = TRUE)
remove.packages("iqpcr")
devtools::install_github("mirzaghaderi/iqpcr", build_vignettes = TRUE)
library(iqpcr)
View(POSTHUC)
library(devtools)
check()
document(
)
check()
check()
x <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
xfl <- x[,1]
x
colnames(x)[1] <- "xxxx"
x
check()
remove.packages("iqpcr")
document()
devtools::install_github("mirzaghaderi/iqpcr", build_vignettes = TRUE)
devtools::install_github("mirzaghaderi/iqpcr", build_vignettes = TRUE)
library(iqpcr)
x <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
a <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1
control	1	2	31.26	2	28.86970731
control	2	2	31.01	2	28.4218226
control	3	2	30.97	2	28.56492605
treatment	1	2	32.65	2	28.31522559
treatment	2	2	32.03	2	29.13993823
treatment	3	2	32.4	2	28.62970485
", header = T)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(2,1),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = TRUE,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(a,
numberOfrefGenes = 1,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = F,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
a <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1	eref2	cref2
control	1	2	31.26	2	28.86970731	2	28.86970731
control	2	2	31.01	2	28.4218226	2	28.4218226
control	3	2	30.97	2	28.56492605	2	28.56492605
treatment	1	2	32.65	2	28.31522559	2	28.31522559
treatment	2	2	32.03	2	29.13993823	2	29.13993823
treatment	3	2	32.4	2	28.62970485	2	28.62970485
", header = T)
oneFACTORfcplot(a,
numberOfrefGenes = 2,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = F,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(a,
numberOfrefGenes = 2,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = T,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 1,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(a,
numberOfrefGenes = 2,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = T,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 0,
y.axis.by = 1,
letter.position.adjust = 0.3,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
oneFACTORfcplot(a,
numberOfrefGenes = 2,
levels = c(1,2),
level.names = c("A1", "A2"),
showCheckLevel = T,
width = 0.5,
fill = "skyblue",
y.axis.adjust = 0,
y.axis.by = 1,
letter.position.adjust = 0.1,
ylab = "Average Fold Change",
xlab = "Pairs",
fontsize = 12)
