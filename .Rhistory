qpcrANOVA(x, numberOfrefGenes = 2)
z <- read.table(text = "
condition	etar	tarct	eref1	cref1	eref2	cref2
control	2	31.26	2	28.86970731	2	28.86970731
control	2	31.01	2	28.4218226	2	28.4218226
control	2	30.97	2	28.56492605	2	28.56492605
treatment	2	32.65	2	28.31522559	2	28.31522559
treatment	2	32.03	2	29.13993823	2	29.13993823
treatment	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
z <- read.table(text = "
a condition	etar	tarct	eref1	cref1	eref2	cref2
control	2	31.26	2	28.86970731	2	28.86970731
control	2	31.01	2	28.4218226	2	28.4218226
control	2	30.97	2	28.56492605	2	28.56492605
treatment	2	32.65	2	28.31522559	2	28.31522559
treatment	2	32.03	2	29.13993823	2	29.13993823
treatment	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(x, numberOfrefGenes = 2)
z <- read.table(text = "
condition	etar	tarct	eref1	cref1	eref2	cref2
control	2	31.26	2	28.86970731	2	28.86970731
control	2	31.01	2	28.4218226	2	28.4218226
control	2	30.97	2	28.56492605	2	28.56492605
treatment	2	32.65	2	28.31522559	2	28.31522559
treatment	2	32.03	2	29.13993823	2	29.13993823
treatment	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(x, numberOfrefGenes = 2)
z <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1	eref2	cref2
control	1	2	31.26	2	28.86970731	2	28.86970731
control	2	2	31.01	2	28.4218226	2	28.4218226
control	3	2	30.97	2	28.56492605	2	28.56492605
treatment	1	2	32.65	2	28.31522559	2	28.31522559
treatment	2	2	32.03	2	29.13993823	2	29.13993823
treatment	3	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(x, numberOfrefGenes = 2)
qpcrANOVA(z, numberOfrefGenes = 2)
z <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST(z, numberOfrefGenes = 2, paired = FALSE, var.equal = FALSE)
z <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST(z, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
z <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1	eref2	cref2
control	1	2	31.26	2	28.86970731	2	28.86970731
control	2	2	31.01	2	28.4218226	2	28.4218226
control	3	2	30.97	2	28.56492605	2	28.56492605
treatment	1	2	32.65	2	28.31522559	2	28.31522559
treatment	2	2	32.03	2	29.13993823	2	29.13993823
treatment	3	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(z, numberOfrefGenes = 2)
zz <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1	eref2	cref2
control	1	2	31.26	2	28.86970731	2	28.86970731
control	2	2	31.01	2	28.4218226	2	28.4218226
control	3	2	30.97	2	28.56492605	2	28.56492605
treatment	1	2	32.65	2	28.31522559	2	28.31522559
treatment	2	2	32.03	2	29.13993823	2	29.13993823
treatment	3	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(zz, numberOfrefGenes = 2)
zz <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1	eref2	cref2
control	1	2	31.26	2	28.86970731	2	28.86970731
control	2	2	31.01	2	28.4218226	2	28.4218226
control	3	2	30.97	2	28.56492605	2	28.56492605
treatment	1	2	32.65	2	28.31522559	2	28.31522559
treatment	2	2	32.03	2	29.13993823	2	29.13993823
treatment	3	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(zz, numberOfrefGenes = 2)
z <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST(z, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
zz <- read.table(text = "
condition	rep	etar	tarct	eref1	cref1	eref2	cref2
control	1	2	31.26	2	28.86970731	2	28.86970731
control	2	2	31.01	2	28.4218226	2	28.4218226
control	3	2	30.97	2	28.56492605	2	28.56492605
treatment	1	2	32.65	2	28.31522559	2	28.31522559
treatment	2	2	32.03	2	29.13993823	2	29.13993823
treatment	3	2	32.4	2	28.62970485	2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrANOVA(zz, numberOfrefGenes = 2)
library(tidyr)
library(dplyr)
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
colnames(x)[1] <- "Condition"
colnames(x)[2] <- "E"
colnames(x)[3] <- "Gene"
colnames(x)[4] <- "Ct"
r <- nrow(x)/(2 * length(unique(x$Gene)))
r
x <- data.frame(x, wCt = log10(x$E) * x$Ct)
x
if(numberOfrefGenes == 1) {
x <- x
} else {
a <- (((2 * r) * (length(unique(x$Gene)) - 2)) + 1)
b <- ((length(unique(x$Gene)) - 1) * 2 * r)
mwCT <- (x$wCt[a:b] - x$wCt[(a+(2*r)):(b+(2*r))])/2
x$wCt[a:b] <- mwCT
x <- x[-((a+(2*r)):(b+(2*r))),]
}
if(numberOfrefGenes == 1) {
x <- x
}
if(numberOfrefGenes == 1) {
x <- x
}
a <- (((2 * r) * (length(unique(x$Gene)) - 2)) + 1)
b <- ((length(unique(x$Gene)) - 1) * 2 * r)
mwCT <- (x$wCt[a:b] - x$wCt[(a+(2*r)):(b+(2*r))])/2
x$wCt[a:b] <- mwCT
x <- x[-((a+(2*r)):(b+(2*r))),]
x
a
b
b
(a+(2*r))
(b+(2*r))
mwCT
(x$wCt[a:b] - x$wCt[(a+(2*r)):(b+(2*r))])
x$wCt[a:b]
x$wCt
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
colnames(x)[1] <- "Condition"
colnames(x)[2] <- "E"
colnames(x)[3] <- "Gene"
colnames(x)[4] <- "Ct"
r <- nrow(x)/(2 * length(unique(x$Gene)))
x <- data.frame(x, wCt = log10(x$E) * x$Ct)
x
a <- (((2 * r) * (length(unique(x$Gene)) - 2)) + 1)
b <- ((length(unique(x$Gene)) - 1) * 2 * r)
x$wCt[a:b]
x$wCt[(a+(2*r)):(b+(2*r))]
(x$wCt[a:b] - x$wCt[(a+(2*r)):(b+(2*r))])
(a+(2*r))
(b+(2*r))
x$wCt[(a+(2*r)):(b+(2*r))
mwCT <- (x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))])/2
x$wCt[a:b]
x$wCt[(a+(2*r)):(b+(2*r))]
x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))]
(x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))])
(x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))])/2
qpcrTTEST <- function(x,
numberOfrefGenes = 1,
paired = FALSE,
var.equal = FALSE) {
colnames(x)[1] <- "Condition"
colnames(x)[2] <- "E"
colnames(x)[3] <- "Gene"
colnames(x)[4] <- "Ct"
r <- nrow(x)/(2 * length(unique(x$Gene)))
if(!all(r %% 1 == 0)) {
stop("Error: Replicates are not equal for all Genes!")
} else {
x <- data.frame(x, wCt = log10(x$E) * x$Ct)
if(numberOfrefGenes == 2) {
x <- x
} else {
a <- (((2 * r) * (length(unique(x$Gene)) - 2)) + 1)
b <- ((length(unique(x$Gene)) - 1) * 2 * r)
mwCT <- (x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))])/2
x$wCt[a:b] <- mwCT
x <- x[-((a+(2*r)):(b+(2*r))),]
}
GENE <- x$Gene
levels_to_compare <- unique(GENE)[-length(unique(GENE))]
res <- matrix(nrow = length(levels_to_compare), ncol=6)
colnames(res) <- c("Gene", "dif", "FC", "LCL", "UCL", "pvalue")
subset <- matrix(NA, nrow = 2 * r, ncol=length(levels_to_compare))
ttest_result <- vector("list", length(levels_to_compare))
for (i in 1:length(levels_to_compare)) {
subset[,i] <- x[GENE == levels_to_compare[i], "wCt"] - x[GENE == utils::tail(unique(GENE), 1), "wCt"]
ttest_result[[i]] <- stats::t.test(subset[(r + 1):(2 * r), i], subset[1:r, i], paired = paired, var.equal = var.equal)
res[i, ] <- c(levels_to_compare[i],
round(mean(subset[(r+1):(2*r),i]) - mean(subset[1:r, i]), 4),
round(10^-((mean(subset[(r+1):(2*r), i]) - mean(subset[1:r,i]))), 4),
round(10^(-ttest_result[[i]]$conf.int[2]), 4), # Lower error bar point
round(10^(-ttest_result[[i]]$conf.int[1]), 4), # Upper error bar point
round(ttest_result[[i]]$p.value, 4))
}
Raw_df <- melt(subset, value.name = "wDCt")[-1]
res <- list(Raw_data = Raw_df, Result = data.frame(res))
return(res)
}
}
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST(x, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
library(reshape2)
qpcrTTEST(x, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
library(reshape2)
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
colnames(x)[1] <- "Condition"
colnames(x)[2] <- "E"
colnames(x)[3] <- "Gene"
colnames(x)[4] <- "Ct"
r <- nrow(x)/(2 * length(unique(x$Gene)))
x <- data.frame(x, wCt = log10(x$E) * x$Ct)
a <- (((2 * r) * (length(unique(x$Gene)) - 2)) + 1)
b <- ((length(unique(x$Gene)) - 1) * 2 * r)
mwCT <- (x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))])/2
mwCT
x$wCt[a:b]
x$wCt[a:b] <- mwCT
((a+(2*r)):(b+(2*r)))
x <- x[-((a+(2*r)):(b+(2*r))),]
x
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST <- function(x,
numberOfrefGenes = 1,
paired = FALSE,
var.equal = FALSE) {
colnames(x)[1] <- "Condition"
colnames(x)[2] <- "E"
colnames(x)[3] <- "Gene"
colnames(x)[4] <- "Ct"
r <- nrow(x)/(2 * length(unique(x$Gene)))
if(!all(r %% 1 == 0)) {
stop("Error: Replicates are not equal for all Genes!")
} else {
x <- data.frame(x, wCt = log10(x$E) * x$Ct)
if(numberOfrefGenes == 2) {
x <- x
} else {
a <- (((2 * r) * (length(unique(x$Gene)) - 2)) + 1)
b <- ((length(unique(x$Gene)) - 1) * 2 * r)
mwCT <- (x$wCt[a:b] + x$wCt[(a+(2*r)):(b+(2*r))])/2
x$wCt[a:b] <- mwCT
x <- x[-((a+(2*r)):(b+(2*r))),]
}
GENE <- x$Gene
levels_to_compare <- unique(GENE)[-length(unique(GENE))]
res <- matrix(nrow = length(levels_to_compare), ncol=6)
colnames(res) <- c("Gene", "dif", "FC", "LCL", "UCL", "pvalue")
subset <- matrix(NA, nrow = 2 * r, ncol=length(levels_to_compare))
ttest_result <- vector("list", length(levels_to_compare))
for (i in 1:length(levels_to_compare)) {
subset[,i] <- x[GENE == levels_to_compare[i], "wCt"] - x[GENE == utils::tail(unique(GENE), 1), "wCt"]
ttest_result[[i]] <- stats::t.test(subset[(r + 1):(2 * r), i], subset[1:r, i], paired = paired, var.equal = var.equal)
res[i, ] <- c(levels_to_compare[i],
round(mean(subset[(r+1):(2*r),i]) - mean(subset[1:r, i]), 4),
round(10^-((mean(subset[(r+1):(2*r), i]) - mean(subset[1:r,i]))), 4),
round(10^(-ttest_result[[i]]$conf.int[2]), 4), # Lower error bar point
round(10^(-ttest_result[[i]]$conf.int[1]), 4), # Upper error bar point
round(ttest_result[[i]]$p.value, 4))
}
Raw_df <- melt(subset, value.name = "wDCt")[-1]
res <- list(Raw_data = Raw_df, Result = data.frame(res))
return(res)
}
}
qpcrTTEST(x, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
data_ttest2 <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86
control	2	ref1	28.42
control	2	ref1	28.56
treatment	2	ref1	28.31
treatment	2	ref1	29.13
treatment	2	ref1	28.62
control	2	ref2	28.43
control	2	ref2	28.90
control	2	ref2	28.17
treatment	2	ref2	28.64
treatment	2	ref2	29.12
treatment	2	ref2	28.95
", header = TRUE, check.names = FALSE)
library(devtools)
use_data(data_ttest2)
setwd("E:/Dropbox/iqpcr/")
use_data(data_ttest2)
document()
remove.packages("iqpcr")
devtools::install_github("mirzaghaderi/iqpcr", build_vignettes = TRUE)
library(iqpcr)
qpcrTTEST(data_ttest2,
paired = FALSE,
var.equal = TRUE,
numberOfrefGenes = 2)
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
control	2	ref2	28.86970731
control	2	ref2	28.4218226
control	2	ref2	28.56492605
treatment	2	ref2	28.31522559
treatment	2	ref2	29.13993823
treatment	2	ref2	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST(x, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
x <- read.table(text = "
condition	E	Gene	Ct
control	2	g	31.26
control	2	g	31.01
control	2	g	30.97
treatment	2	g	32.65
treatment	2	g	32.03
treatment	2	g	32.4
control	2	ref1	28.86970731
control	2	ref1	28.4218226
control	2	ref1	28.56492605
treatment	2	ref1	28.31522559
treatment	2	ref1	29.13993823
treatment	2	ref1	28.62970485
", header = TRUE, check.names = FALSE)
qpcrTTEST(x, numberOfrefGenes = 2, paired = FALSE, var.equal = T)
qpcrTTEST(x, numberOfrefGenes = 1, paired = FALSE, var.equal = T)
